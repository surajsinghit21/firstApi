name: pipeline_firstApi

on:
  push:
    branches: [ master ]
  
  pull_request:
    branches: [ master ]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: checkout repo
      uses: actions/checkout@v4

    - name: Test Keyword...
      run: echo $secrets.SONAR_TOKEN
      
    - name: setup .net
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: '8.0.x'
        
    - name: Install Sonar Cloud
      uses: SonarSource/sonarcloud-github-action@v2
      with:
        organization: surajsinghit21
        projectkey: firstApi
        token: ${{ secrets.SONAR_TOKEN }}
        
    - name: restore dep.
      run: dotnet restore
      
    - name: build
      run: dotnet build --configuration Release --no-restore

    - name: test
      run: dotnet test --no-build --verbosity normal

    - name: Publish Output
      run: dotnet publish -c Release -o output

    - name: publish output
      run: dotnet publish -c Release -o output
      
